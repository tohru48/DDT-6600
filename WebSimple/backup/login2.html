<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Giriş - Webgame Gunny Online</title>
  <link rel="shortcut icon" href="favicon.ico" />
  <link rel="stylesheet" type="text/css" href="css/mainsite.css" />
  <link rel="stylesheet" type="text/css" href="css/gunny-index.css" />
  <!-- Gereksiz olan CSS ve JS dosyaları (örneğin thickbox) kullanım varsa elle eklenmeli -->

  <script type="text/javascript" src="script/mainsite.js"></script>
  <script type="text/javascript" src="script/gunny-index.js"></script>
  
  <script type="text/javascript">
    // Sayfa yüklendiğinde kullanıcı adı alanına odaklan
    window.onload = function () {
      document.getElementById("u").focus();

      document.getElementById("p").addEventListener("keypress", function (e) {
        if (e.keyCode === 13) {
          checklogin();
        }
      });
    };

    // Giriş bilgilerini kontrol et
    function checklogin() {
      var err = 0;

      if (document.getElementById("u").value === '') {
        document.getElementById("Question").innerHTML = 'Lütfen kullanıcı adınızı giriniz!';
        err++;
      } else if (document.getElementById("p").value === '') {
        document.getElementById("Question").innerHTML = 'Lütfen şifrenizi giriniz!';
        err++;
      }

      if (err === 0) {
        xmlhttpPost("createLogin.ashx");
      }
      return false;
    }

    // AJAX ile giriş gönderimi
    function xmlhttpPost(strURL) {
      var xmlHttpReq = new XMLHttpRequest();
      document.getElementById("Question").innerHTML = '<img alt="Yükleniyor..." src="images/loading.gif" />';

      xmlHttpReq.open('POST', strURL, true);
      xmlHttpReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
      xmlHttpReq.onreadystatechange = function () {
        if (xmlHttpReq.readyState === 4) {
          updatepage(xmlHttpReq.responseText);
        }
      };
      xmlHttpReq.send(getquerystring());
    }

    // Form verisini sırala
    function getquerystring() {
      var form = document.forms['frmLogin'];
      var username = form.u.value;
      var password = form.p.value;
      return 'username=' + encodeURIComponent(username) + '&password=' + encodeURIComponent(password);
    }

    // Sunucu yanıtını işle
    function updatepage(response) {
      if (response === "ok") {
        window.location.replace("LoginGame.aspx");
      } else {
        document.getElementById("Question").innerHTML = response;
      }
    }
  </script>
</head>
<body>
  <div id="thewindowbackground"></div>
  <div id="wrapper">
    <div id="container">
      <div id="header">
        <div class="WrapperOutContent">
          <div class="Content">
            <div class="LeftContent">
              <form id="frmLogin" name="frmLogin" method="post" action="">
                <div class="frm_dangnhap">
                  <label>Kullanıcı Adı:</label>
                  <input type="text" name="u" id="u" class="txt_box" />

                  <label>Şifre:</label>
                  <input type="password" id="p" name="p" class="txt_box" />
                </div>

                <div class="frm_button">
                  <input type="submit" value="Hemen Giriş Yap" class="ChoiNgay" onclick="return checklogin();" />
                </div>
              </form>

              <div id="Question"></div>

              <div class="BlockNewUser">
                <ul class="BtnNewUser">
                  <li>
                    <a href="./auth/register.aspx?pid=49&eventid=63&bannerid=732&type=154" title="Hızlı Kayıt Ol" target="_blank">
                      Hızlı Kayıt Ol
                    </a>
                  </li>
                </ul>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
